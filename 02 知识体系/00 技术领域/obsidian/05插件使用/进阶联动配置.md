# Templater + QuickAdd + Dataview

## 核心目标

搭建 **银行系统接口文档自动化管理库**，实现「一键生成接口文档→自动归类→结构化查询」全流程，适配双录 / 音视频集群等系统的接口管理需求。

## 前置准备

1. 确保已安装并启用 **Templater、QuickAdd、Dataview** 三款插件。
2. 在 Obsidian 库中创建以下目录结构：
    
    plaintext
    
    ```
    ├── Templates/           # 存放模板文件
    │   └── 接口文档模板.md
    ├── 接口文档/            # 存放生成的接口文档
    └── 数据看板/            # 存放Dataview查询面板
        └── 接口总览看板.md
    ```
    

## 第一步：配置 Templater 动态模板

### 1. 模板文件编写（`Templates/接口文档模板.md`）

该模板包含**标准化元数据 + Java 代码块 + 测试要点**，适配后端接口文档规范。

markdown

````
---
title: <% tp.file.title %>
模块: <% tp.system.prompt("请输入所属模块（如：双录系统/音视频集群）") %>
接口路径: <% tp.system.prompt("请输入接口路径，如/api/v1/record/upload") %>
请求方式: <% tp.system.suggester(["POST", "GET", "PUT", "DELETE"], ["POST", "GET", "PUT", "DELETE"], true, "请选择请求方式") %>
负责人: <% tp.frontmatter["author"] || "你的名字" %>
创建时间: <% tp.date.now("YYYY-MM-DD HH:mm:ss") %>
状态: <% tp.system.suggester(["设计中", "开发中", "测试中", "已上线"], ["设计中", "开发中", "测试中", "已上线"], true, "请选择接口状态") %>
---

# <% tp.file.title %>
## 1. 接口信息
| 项目         | 内容                     |
|--------------|--------------------------|
| 所属模块     | <% tp.frontmatter["模块"] %> |
| 接口路径     | <% tp.frontmatter["接口路径"] %> |
| 请求方式     | <% tp.frontmatter["请求方式"] %> |
| 负责人       | <% tp.frontmatter["负责人"] %> |
| 当前状态     | <% tp.frontmatter["状态"] %> |
| 创建时间     | <% tp.frontmatter["创建时间"] %> |

## 2. 入参说明
### 2.1 入参类型
application/json

### 2.2 POJO 示例
```java
public class <% tp.file.title.replace("接口-", "") %>Request {
    // 示例字段，请根据实际业务修改
    private String id; // 业务唯一标识
    private String fileName; // 文件名称
    // getter & setter
}
````

## 3. 出参说明

### 3.1 出参类型

application/json

### 3.2 POJO 示例

java

运行

```java
public class <% tp.file.title.replace("接口-", "") %>Response {
    private int code; // 响应码 200成功/500失败
    private String msg; // 响应信息
    private Object data; // 响应数据
    // getter & setter
}
```

## 4. 测试要点

- [ ] 入参非空校验
- [ ] 异常场景覆盖（如文件过大、权限不足）
- [ ] 响应码正确性验证

````plaintext
### 2. Templater 基础配置
1.  打开 **设置 → Templater**
2.  设置 **Template folder location** 为 `Templates`
3.  勾选 **Enable User System Functions**（允许脚本执行）
4.  可选：设置默认作者（在插件设置的 `User Template Variables` 中添加 `author: 你的名字`）

## 第二步：配置 QuickAdd 一键生成文档
### 1. 创建 QuickAdd 选择项
1.  打开 **设置 → QuickAdd**，点击 `Manage Choices` → `Add Choice`
2.  命名为 **新建接口文档**，选择类型为 `Template`
3.  配置关键参数：
    - **Template File**：选择 `Templates/接口文档模板.md`
    - **File Name**：填写 `接口-{{DATE:YYYYMMDDHHmmss}}`（自动生成唯一文件名）
    - **Folder Path**：选择 `接口文档`（文档自动归类到该目录）
    - 勾选 **Open file after creation**（生成后自动打开编辑）
    - 勾选 **Use Templater to parse template**（启用Templater动态解析）

### 2. 设置快捷键
1.  回到 QuickAdd 主设置界面，点击 `Add Hotkey`
2.  为 **新建接口文档** 绑定快捷键（推荐 `Ctrl+Shift+I`）

### 3. 测试一键生成
按下快捷键 `Ctrl+Shift+I`，按照弹窗提示输入模块、接口路径等信息，即可自动生成标准化接口文档。

## 第三步：配置 Dataview 结构化查询看板
### 1. 编写查询面板（`数据看板/接口总览看板.md`）
该看板支持**按模块筛选、按状态分类、快速跳转文档**，适配项目管理需求。
```markdown
# 接口文档总览看板
> 数据实时更新，点击文档标题可直接跳转

## 1. 按模块分组（所有接口）
```dataview
TABLE 
    接口路径 as "接口路径",
    请求方式 as "请求方式",
    负责人 as "负责人",
    状态 as "状态"
FROM "接口文档"
WHERE contains(模块, "")
SORT 创建时间 DESC
GROUP BY 模块
````

## 2. 按状态筛选（开发中 / 测试中）

### 2.1 开发中接口

```dataview
TABLE 
    模块 as "所属模块",
    接口路径 as "接口路径",
    负责人 as "负责人"
FROM "接口文档"
WHERE 状态 = "开发中"
SORT 创建时间 DESC
```

### 2.2 测试中接口
```dataview
TABLE 
    模块 as "所属模块",
    接口路径 as "接口路径",
    负责人 as "负责人"
FROM "接口文档"
WHERE 状态 = "测试中"
SORT 创建时间 DESC
```

## 3. 个人负责接口

dataview

```txt
TABLE 
    模块 as "所属模块",
    状态 as "状态",
    创建时间 as "创建时间"
FROM "接口文档"
WHERE 负责人 = "你的名字"
SORT 创建时间 DESC
```

plaintext

```

### 2. Dataview 配置要点
1.  确保 **接口文档** 目录下的文件都包含完整 YAML 元数据（模板已自动生成）
2.  看板中的 `你的名字` 替换为实际名称，实现个人接口筛选
3.  支持扩展查询条件（如按请求方式筛选 `WHERE 请求方式 = "POST"`）

## 第四步：联动优化 & 避坑指南
### 1. 进阶联动技巧
- **批量更新接口状态**：在 Dataview 看板中直接编辑文档的 `状态` 字段，保存后看板自动刷新。
- **关联测试用例**：在模板中添加 `测试用例链接` 字段，关联 `测试用例` 目录下的笔记，实现接口与用例双向跳转。
- **自动生成接口清单**：在项目总结文档中嵌入 Dataview 查询，自动汇总该项目下所有接口。

### 2. 避坑指南
- **模板路径问题**：Templater 的模板路径必须为相对路径，且目录名称不含空格/特殊字符。
- **Dataview 查询不生效**：检查 YAML 字段名是否一致（如 `接口路径` 不能写成 `接口url`）。
- **QuickAdd 生成失败**：确保 `接口文档` 目录已创建，且文件名格式符合 Obsidian 要求。

---

需要我再补充**接口文档与测试用例的双向联动配置**（基于 Dataview 实现接口-用例-缺陷的关联追踪）吗？
```