<%*
// 核心配置（集中管理+交互输入）
const config = {
  folder: "03 工作项目", // 自动创建「会议纪要」文件夹
  meetingName: await tp.system.prompt("会议名称", "双录系统接口评审会"),
  attendees: await tp.system.prompt("参会人员", "后端/测试/产品"),
  date: tp.date.now("YYYY-MM-DD HH:mm"),
  recorder: tp.frontmatter?.author || "（记录人）",
  timeStr: tp.date.now("YYYYMMDDHHmmss") // 用于文件名
};

// 1. 自动创建「会议纪要」文件夹（不存在则创建）
const folder = app.vault.getAbstractFileByPath(config.folder);
if (!folder) await app.vault.createFolder(config.folder);

// 2. 定义文件名（避免重复）
const fileName = `会议纪要-${config.meetingName.replace(/\//g, "-")}-${config.timeStr}.md`;

// 3. 构造会议纪要内容（变量通过JS插值解析）
const content = `---
title: ${config.meetingName}纪要
日期: ${config.date}
参会人: ${config.attendees}
记录人: ${config.recorder}
---
# ${config.meetingName}纪要
## 一、会议议题
1. 
2. 

## 二、核心结论
| 议题 | 结论 | 备注 |
|------|------|------|
|      |      |      |

## 三、待办事项
| 任务 | 负责人 | 截止日期 | 状态 |
|------|--------|----------|------|
|      |        |          | 待处理 |

## 四、后续安排
- 下次会议时间：
- 需前置准备：
`;

// 4. 生成文件到指定文件夹
const fullPath = `${config.folder}/${fileName}`;
await app.vault.create(fullPath, content);

// 5. 自动打开文件+提示成功
const newFile = app.vault.getAbstractFileByPath(fullPath);
if (newFile) await app.workspace.getLeaf().openFile(newFile);
new Notice(`✅ ${config.meetingName} 纪要已生成`, 2000);
%>