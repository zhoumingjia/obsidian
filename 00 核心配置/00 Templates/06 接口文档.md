<%*
// 核心配置（集中管理，便于修改）
const config = {
  folder: "03 工作项目",
  module: "双录系统/音视频集群",
  author: tp.frontmatter?.author || "（填写作者）",
  dateFormat: {
    file: "YYYYMMDDHHmmss",
    create: "YYYY-MM-DD HH:mm"
  }
};

// 1. 统一日期变量（精简调用）
const timeStr = tp.date.now(config.dateFormat.file);
const createTime = tp.date.now(config.dateFormat.create);
const fileName = `接口-${timeStr}.md`;

// 2. 自动创建文件夹（精简逻辑）
const folder = app.vault.getAbstractFileByPath(config.folder);
if (!folder) await app.vault.createFolder(config.folder);

// 轻量交互：输入接口名称
const apiName = await tp.system.prompt("请输入接口名称（如：音视频上传）", "未命名接口");
const apiPath = `/api/${apiName.toLowerCase().replace(/\s+/g, "-")}`;

// 3. 构造简洁美观的文档内容（无表格）
const content = `---
title: 接口-${apiName}-${timeStr}
模块: ${config.module}
作者: ${config.author}
创建时间: ${createTime}
---
## 接口基础信息
**接口名称**：${apiName}
**接口路径**：${apiPath}
**请求方式**：POST/GET
**数据格式**：JSON (application/json)
**接口状态**：待开发

## 入参示例
\`\`\`java
// ${apiName}入参DTO
public class ${apiName.replace(/\s+/g, "")}RequestDTO {
    private String id; // 唯一标识
}
\`\`\`

## 出参示例
\`\`\`java
// ${apiName}通用响应体
public class ${apiName.replace(/\s+/g, "")}ResponseDTO<T> {
    private int code;    // 响应码（200成功/500失败）
    private String msg;  // 响应信息
    private T data;      // 响应数据体
}
\`\`\`

## 业务说明
- 功能描述：
- 异常场景：
- 关联接口：
`;

// 4. 生成文件并自动打开
const fullPath = `${config.folder}/${fileName}`;
await app.vault.create(fullPath, content);
const newFile = app.vault.getAbstractFileByPath(fullPath);
if (newFile) await app.workspace.getLeaf().openFile(newFile);

// 5. 简洁提示
new Notice(`✅ ${apiName} 接口文档生成成功`, 2000);
%>