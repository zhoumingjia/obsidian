<%*
// 日记专属配置
const config = {
  rootFolder: "01 日常笔记",
  dailyFolderCN: "日记",
  yearFolder: tp.date.now("YYYY"),
  monthFolder: tp.date.now("MM"),
  date: tp.date.now("YYYY-MM-DD"),
  timeStr: tp.date.now("YYYYMMDD"),
  mood: await tp.system.prompt("今日心情（可选）", "🌟 平静"),
  focus: await tp.system.prompt("今日核心关键词（可选）", ""),
  author: tp.frontmatter?.author || tp.config?.user_name || "自己",
  fileName: `${tp.date.now("YYYY-MM-DD")}.md`
};

// 自动创建年/月分层文件夹
const createFolder = async (path) => {
  if (!app.vault.getAbstractFileByPath(path)) await app.vault.createFolder(path);
};
await createFolder(config.rootFolder);
await createFolder(`${config.rootFolder}/${config.yearFolder}`);
await createFolder(`${config.rootFolder}/${config.yearFolder}/${config.monthFolder}/${config.dailyFolderCN}`);

// 文件完整路径
const fullPath = `${config.rootFolder}/${config.yearFolder}/${config.monthFolder}/${config. dailyFolderCN}/${config.fileName}`;

// 防止文件重复
if (app.vault.getAbstractFileByPath(fullPath)) {
  new Notice(`⚠️ 今日日记已存在！`, 3000);
  return;
}

// 日记内容模板
const content = `---
title: 每日记录 - ${config.date}
date: ${tp.date.now("YYYY-MM-DD HH:mm:ss")}
author: ${config.author}
type: daily
mood: ${config.mood}
focus: ${config.focus || "无"}
tags:  ["日记", "日常", ${config.yearFolder}年, "每日记录"]
---

# 📝 每日记录 | ${config.date}
## 一、今日概览
- 心情状态：${config.mood}
- 核心关键词：${config.focus || "无"}
- 天气/环境： 

## 二、今日完成清单
### 🔧 工作/学习
- [ ] 
- [ ] 

### 🏠 生活/琐事
- [ ] 
- [ ] 

### 📚 成长/提升
- 阅读：
- 学习：
- 运动：

## 三、今日感悟
- ✨ 开心的事：
- 📌 遗憾的事：
- 💡 收获与思考：

## 四、明日待办
| 任务 | 优先级 | 截止时间 | 状态 |
|------|--------|----------|------|
|      | 高/中/低 |          | 未开始 |
|      | 高/中/低 |          | 未开始 |

## 五、随手记
- 灵感/想法：
- 待整理资料：
- 其他：
`;

// 生成文件并打开
await app.vault.create(fullPath, content);
const newFile = app.vault.getAbstractFileByPath(fullPath);
if (newFile) await app.workspace.getLeaf().openFile(newFile);
new Notice(`✅ 今日日记已生成！`, 2000);
%>